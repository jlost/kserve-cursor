---
description: Setting up the development environment to run local code changes and E2E tests
alwaysApply: false
---

# Development Environments

Choose the execution environment based on which fork you're working on.

**Before setting up an environment, detect the target fork.** See `fork-structure.mdc` for detection rules based on:
- Branch name patterns (e.g., `RHOAIENG-*-odh-*` -> ODH)
- Git tracking branch (e.g., tracking `upstream/*` -> Upstream)
- JIRA ticket prefix (e.g., `RHOAIENG-*` -> ODH/Downstream, never upstream)

## Fork to Environment Mapping

| Fork | Environment | Cluster Type | Notes |
|------|-------------|--------------|-------|
| Upstream (kserve/kserve) | Kind | Kubernetes | Vanilla K8s with Istio/Knative |
| ODH (opendatahub-io/kserve) | CRC | OpenShift | ODH operator installed |
| Downstream (red-hat-data-services/kserve) | CRC | OpenShift | RHOAI operator installed |

**Kind and CRC cannot run simultaneously.** Stop one before starting the other.

## Environment Setup by Fork

### Upstream (kserve/kserve) -> Kind

Use Kind for upstream work. This is vanilla Kubernetes without OpenShift-specific features.

**MCP Tools (executein order):**

1. `mcp_ignition-mcp_task_kind_refresh`
2. `mcp_ignition-mcp_task_install_kserve_dependencies`
3. `mcp_ignition-mcp_task_install_network_dependencies`
4. `mcp_ignition-mcp_task_clean_deploy_kserve`
5. `mcp_ignition-mcp_task_patch_deployment_mode`

**Now, launch the devspace session to run local code changes:**
- `mcp_ignition-mcp_launch_devspace`

**To run E2E tests:**
- `mcp_ignition-mcp_launch_e2e_test_kind`

### ODH/Downstream -> CRC (OpenShift)

Use CRC for ODH or downstream work. Required for OpenShift-specific features.

**MCP Tools (in order):**

1. `mcp_ignition-mcp_task_crc_refresh`
2. `mcp_ignition-mcp_task_pull_secret`

There are two paths you can take from here:

- Operator Path - Ideal for parity with production for manual testing
    3. `mcp_ignition-mcp_task_install_odh_rhoai_operator`
    4. `mcp_ignition-mcp_task_apply_dsci_dsc`

- E2E Path - Ideal for parity with CI/CD for automated testing
    3. `mcp_ignition-mcp_task_setup_e2e`
    4. `mcp_ignition-mcp_task_recreate_e2e_ns`

**Now, launch the devspace session to run local code changes:**
- `mcp_ignition-mcp_launch_devspace`

**To run E2E tests:**
- `mcp_ignition-mcp_launch_e2e_test_odh_rhoai`

## Feature Availability by Environment

| Feature | Kind | CRC |
|---------|:----:|:---:|
| RawDeployment mode | Yes | Yes |
| Serverless mode | Yes | Yes |
| OpenShift Routes | No | Yes |
| ServiceMesh (Maistra) | No | Yes |
| ODH Dashboard | No | Yes |
| `kserve_on_openshift` tests | No | Yes |

## Switching Environments

To switch from Kind to CRC:
`kind delete cluster`
Now follow the steps for CRC to setup the environment.

To switch from CRC to Kind:
`crc stop`
Now follow the steps for Kind to setup the environment.

## Running Local Code

To run the code with local changes, start a devspace session. This will also provide a debugger for the code:

1. Ensure cluster is running (Kind or CRC)
2. `mcp_ignition-mcp_launch_devspace`
