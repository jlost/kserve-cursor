---
description: KServe three-tier fork hierarchy and branch targeting rules
alwaysApply: true
---

# KServe Fork Structure

This project is a fork of KServe with a three-tier fork hierarchy. Always consider this context when assisting with development tasks.

## Fork Hierarchy

```
kserve/kserve (upstream)
    |
    v
opendatahub-io/kserve (midstream/ODH)
    |
    v
red-hat-data-services/kserve (downstream/RHODS)
```

## Git Remote Naming Convention

When working with git commands or analyzing branches, expect these remote names:
- `upstream` -> kserve/kserve
- `odh` -> opendatahub-io/kserve
- `downstream` -> red-hat-data-services/kserve
- `origin` -> user's personal fork

## Initial Workspace Setup

**Configure git remotes** using the setup script:

```bash
.cursor/scripts/setup-git-remotes.sh
```

This interactive script will:
- Configure `upstream` (kserve/kserve)
- Configure `odh` (opendatahub-io/kserve)
- Configure `downstream` (red-hat-data-services/kserve)
- Configure `origin` (your personal fork)
- Fetch all remotes

Run this once when setting up a new workspace or clone.

## Branch Targeting Rules

When determining which branch to base work on:

| Change Type | Target Fork | Base Branch |
|-------------|-------------|-------------|
| New upstream feature | kserve/kserve | `master` |
| ODH-specific feature (latest) | opendatahub-io/kserve | `master` |
| ODH-specific feature (older) | opendatahub-io/kserve | `release-vX.Y` or `stable-X.x` |
| Downstream-only change (latest) | red-hat-data-services/kserve | `main` |
| Downstream-only change (older) | red-hat-data-services/kserve | `rhoai-X.Y` |
| Backport from downstream | opendatahub-io/kserve | `master` |

### Branch Mapping Between Forks

ODH and downstream branches correspond to specific RHOAI product versions:

| RHOAI Version | ODH Branch | Downstream Branch |
|---------------|------------|-------------------|
| 3.x (latest)  | `master`   | `main`            |
| 2.x (stable)  | `stable-2.x` or `release-vX.Y` | `rhoai-2.Y` |

### Cherry-Pick Flow

**Always go through ODH first.** Changes flow: upstream -> ODH -> downstream.

To get a fix into a specific RHOAI version:
1. First merge to the corresponding ODH branch (e.g., `odh/stable-2.x` for RHOAI 2.25)
2. Then cherry-pick to the corresponding downstream branch (e.g., `downstream/rhoai-2.25`)

**Never target downstream directly** without first having the change in ODH.

## Code Sync Patterns

When syncing code between forks:
1. Upstream releases are merged into ODH `master` periodically
2. ODH release branches are cut from `master` after upstream release integration
3. Cherry-picks flow: upstream -> ODH -> downstream (always ODH first)
4. Bug fixes may flow: ODH -> upstream (backports)

## Reference Documentation

- ODH contribution guide: `CONTRIBUTING.md`
- Upstream release fetch process: `docs/odh/fetch-upstream-release.md`
